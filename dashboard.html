<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Travelasha Admin Dashboard</title>
    <link rel="stylesheet" href="dashboard.css">
</head>
<body>
    <div class="sidebar">
        <div class="logo">
            <h3>Travelasha</h3>
        </div>
        <a href="#dashboard" class="active" onclick="showSection('dashboard', this)">Dashboard</a>
        <a href="#packages" onclick="showSection('packages', this)">Packages</a>
        <a href="#bookings" onclick="showSection('bookings', this)">Bookings</a>
        <a href="#users" onclick="showSection('users', this)">Users</a>
        <a href="#analytics" onclick="showSection('analytics', this)">Analytics</a>
        <a href="#settings" onclick="showSection('settings', this)">Settings</a>
        <a href="#" onclick="logout()">Logout</a>
    </div>

    <div class="main">
        <div class="header">
            <h1>Admin Dashboard</h1>
            <div class="header-actions">
                <div class="user-info">
                    Welcome, Admin
                </div>
                <button class="btn btn-sm" onclick="refreshData()">Refresh</button>
            </div>
        </div>

        <!-- Dashboard Section -->
        <div id="dashboard" class="content-section">
            <h2>Dashboard Overview</h2>
            <div class="stats">
                <div class="stat">
                    <h3 id="totalPackages">0</h3>
                    <p>Total Packages</p>
                </div>
                <div class="stat">
                    <h3 id="totalBookings">0</h3>
                    <p>Total Bookings</p>
                </div>
                <div class="stat">
                    <h3 id="totalUsers">0</h3>
                    <p>Total Users</p>
                </div>
                <div class="stat">
                    <h3 id="revenue">₹0</h3>
                    <p>Total Revenue</p>
                </div>
            </div>
        </div>

        <!-- Packages Section -->
        <div id="packages" class="content-section" style="display: none;">
            <h2>Package Management</h2>
            <div style="margin-bottom: 20px;">
                <button class="btn btn-success" onclick="showAddPackageForm()">Add New Package</button>
            </div>
            <div style="margin-bottom: 20px;">
                <input type="text" id="packageSearch" placeholder="Search packages..." onkeyup="searchPackages()">
                <select id="packageFilterCategory" onchange="filterPackages()" style="width: 200px; display: inline-block;">
                    <option value="all">All Categories</option>
                    <option value="Adventure">Adventure</option>
                    <option value="Beach">Beach</option>
                    <option value="Mountain">Mountain</option>
                    <option value="City">City</option>
                </select>
                <select id="packageFilterStatus" onchange="filterPackages()" style="width: 200px; display: inline-block;">
                    <option value="all">All Status</option>
                    <option value="Active">Active</option>
                    <option value="Inactive">Inactive</option>
                </select>
            </div>
            <table id="packagesTable">
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Category</th>
                        <th>Price</th>
                        <th>Duration</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="packagesTableBody">
                    <!-- Packages will be loaded here -->
                </tbody>
            </table>
        </div>

        <!-- Add/Edit Package Form (Hidden by default) -->
        <div id="addPackageForm" class="modal">
            <div class="modal-content">
                <span class="close" onclick="hideAddPackageForm()">&times;</span>
                <h2 id="packageFormTitle">Add New Package</h2>
                <form onsubmit="savePackage(event)">
                    <input type="hidden" id="editingPackageId">
                    
                    <div class="form-group">
                        <label for="packageName">Package Name</label>
                        <input type="text" id="packageName" required>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="packagePrice">Price (₹)</label>
                            <input type="number" id="packagePrice" required>
                        </div>
                        <div class="form-group">
                            <label for="packageDuration">Duration</label>
                            <input type="text" id="packageDuration" placeholder="e.g., 5 days 4 nights" required>
                        </div>
                    </div>
                    
                    <div class="form-row">
                        <div class="form-group">
                            <label for="packageCategory">Category</label>
                            <select id="packageCategory" required>
                                <option value="">Select Category</option>
                                <option value="Adventure">Adventure</option>
                                <option value="Beach">Beach</option>
                                <option value="Mountain">Mountain</option>
                                <option value="City">City</option>
                            </select>
                        </div>
                        <div class="form-group">
                            <label for="packageDifficulty">Difficulty</label>
                            <select id="packageDifficulty" required>
                                <option value="">Select Difficulty</option>
                                <option value="Easy">Easy</option>
                                <option value="Moderate">Moderate</option>
                                <option value="Difficult">Difficult</option>
                            </select>
                        </div>
                    </div>
                    
                    <div class="form-group">
                        <label for="packageDescription">Description</label>
                        <textarea id="packageDescription" rows="4" required></textarea>
                    </div>
                    
                    <div style="text-align: right; margin-top: 20px;">
                        <button type="button" class="btn" onclick="hideAddPackageForm()">Cancel</button>
                        <button type="submit" class="btn btn-success">Save Package</button>
                    </div>
                </form>
            </div>
        </div>

        <!-- Bookings Section -->
        <div id="bookings" class="content-section" style="display: none;">
            <h2>Booking Management</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Customer</th>
                        <th>Package</th>
                        <th>Date</th>
                        <th>Amount</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="bookingsTableBody">
                    <!-- Bookings will be loaded here -->
                </tbody>
            </table>
        </div>

        <!-- Users Section -->
        <div id="users" class="content-section" style="display: none;">
            <h2>User Management</h2>
            <table>
                <thead>
                    <tr>
                        <th>ID</th>
                        <th>Name</th>
                        <th>Email</th>
                        <th>Phone</th>
                        <th>Registered</th>
                        <th>Status</th>
                        <th>Actions</th>
                    </tr>
                </thead>
                <tbody id="usersTableBody">
                    <!-- Users will be loaded here -->
                </tbody>
            </table>
        </div>

        <!-- Analytics Section -->
        <div id="analytics" class="content-section" style="display: none;">
            <h2>Analytics</h2>
            <div class="stats">
                <div class="stat">
                    <h3 id="activePackages">0</h3>
                    <p>Active Packages</p>
                </div>
                <div class="stat">
                    <h3 id="pendingBookings">0</h3>
                    <p>Pending Bookings</p>
                </div>
                <div class="stat">
                    <h3 id="avgPackagePrice">₹0</h3>
                    <p>Average Package Price</p>
                </div>
                <div class="stat">
                    <h3 id="conversionRate">0%</h3>
                    <p>Conversion Rate</p>
                </div>
            </div>
        </div>

        <!-- Settings Section -->
        <div id="settings" class="content-section" style="display: none;">
            <h2>Settings</h2>
            <div class="form-group">
                <label>Site Name</label>
                <input type="text" value="Travelasha">
            </div>
            <div class="form-group">
                <label>Admin Email</label>
                <input type="email" value="admin@travelasha.com">
            </div>
            <div class="form-group">
                <label>Currency</label>
                <select>
                    <option value="INR" selected>Indian Rupee (₹)</option>
                    <option value="USD">US Dollar ($)</option>
                    <option value="EUR">Euro (€)</option>
                </select>
            </div>
            <button class="btn btn-success">Save Settings</button>
        </div>
    </div>

    <script>
        // Initialize data
        let packages = JSON.parse(localStorage.getItem('packages') || '[]');
        let bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
        let users = JSON.parse(localStorage.getItem('users') || '[]');

        // Initialize sample data if empty
        if (packages.length === 0) {
            packages = [
                {
                    id: 1,
                    name: 'Himalayan Adventure',
                    category: 'Adventure',
                    price: 25000,
                    duration: '7 days 6 nights',
                    difficulty: 'Difficult',
                    description: 'Experience the majestic Himalayas with expert guides.',
                    status: 'Active'
                },
                {
                    id: 2,
                    name: 'Goa Beach Paradise',
                    category: 'Beach',
                    price: 15000,
                    duration: '5 days 4 nights',
                    difficulty: 'Easy',
                    description: 'Relax on the beautiful beaches of Goa.',
                    status: 'Active'
                }
            ];
            localStorage.setItem('packages', JSON.stringify(packages));
        }

        // Show section
        function showSection(sectionId, linkElement) {
            // Hide all sections
            document.querySelectorAll('.content-section').forEach(section => {
                section.style.display = 'none';
            });
            
            // Remove active class from all links
            document.querySelectorAll('.sidebar a').forEach(link => {
                link.classList.remove('active');
            });
            
            // Show selected section
            document.getElementById(sectionId).style.display = 'block';
            linkElement.classList.add('active');
            
            // Load data for the section
            if (sectionId === 'packages') {
                loadPackages();
            } else if (sectionId === 'bookings') {
                loadBookings();
            } else if (sectionId === 'users') {
                loadUsers();
            } else if (sectionId === 'dashboard' || sectionId === 'analytics') {
                updateDashboardStats();
            }
        }

        // Update dashboard statistics
        function updateDashboardStats() {
            const totalPackages = packages.length;
            const activePackages = packages.filter(p => p.status === 'Active').length;
            const totalBookings = bookings.length;
            const totalUsers = users.length;
            
            const revenue = bookings.reduce((sum, booking) => sum + (booking.amount || 0), 0);
            const avgPrice = totalPackages > 0 ? Math.round(packages.reduce((sum, pkg) => sum + pkg.price, 0) / totalPackages) : 0;
            
            document.getElementById('totalPackages').textContent = totalPackages;
            document.getElementById('totalBookings').textContent = totalBookings;
            document.getElementById('totalUsers').textContent = totalUsers;
            document.getElementById('revenue').textContent = '₹' + revenue.toLocaleString('en-IN');
            
            document.getElementById('activePackages').textContent = activePackages;
            document.getElementById('avgPackagePrice').textContent = '₹' + avgPrice.toLocaleString('en-IN');
            document.getElementById('conversionRate').textContent = totalUsers > 0 ? Math.round((totalBookings / totalUsers) * 100) + '%' : '0%';
        }

        // Load packages
        function loadPackages() {
            const tbody = document.getElementById('packagesTableBody');
            tbody.innerHTML = '';
            
            packages.forEach(pkg => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${pkg.id}</td>
                    <td>${pkg.name}</td>
                    <td>${pkg.category}</td>
                    <td>₹${pkg.price.toLocaleString('en-IN')}</td>
                    <td>${pkg.duration}</td>
                    <td><span class="status-badge status-${pkg.status.toLowerCase()}">${pkg.status}</span></td>
                    <td>
                        <button class="btn btn-sm" onclick="editPackage(${pkg.id})">Edit</button>
                        <button class="btn btn-sm btn-danger" onclick="togglePackageStatus(${pkg.id})">${pkg.status === 'Active' ? 'Deactivate' : 'Activate'}</button>
                    </td>
                `;
            });
        }

        // Show add package form
        function showAddPackageForm() {
            document.getElementById('addPackageForm').style.display = 'block';
            document.getElementById('packageFormTitle').textContent = 'Add New Package';
            document.getElementById('editingPackageId').value = '';
            document.getElementById('packageName').value = '';
            document.getElementById('packagePrice').value = '';
            document.getElementById('packageDuration').value = '';
            document.getElementById('packageCategory').value = '';
            document.getElementById('packageDifficulty').value = '';
            document.getElementById('packageDescription').value = '';
        }

        // Hide add package form
        function hideAddPackageForm() {
            document.getElementById('addPackageForm').style.display = 'none';
        }

        // Save package
        function savePackage(event) {
            event.preventDefault();
            
            const editingId = document.getElementById('editingPackageId').value;
            const packageData = {
                name: document.getElementById('packageName').value,
                price: parseInt(document.getElementById('packagePrice').value),
                duration: document.getElementById('packageDuration').value,
                category: document.getElementById('packageCategory').value,
                difficulty: document.getElementById('packageDifficulty').value,
                description: document.getElementById('packageDescription').value,
                status: 'Active'
            };
            
            if (editingId) {
                // Edit existing package
                const index = packages.findIndex(p => p.id == editingId);
                if (index !== -1) {
                    packages[index] = { ...packages[index], ...packageData };
                }
            } else {
                // Add new package
                const newId = packages.length > 0 ? Math.max(...packages.map(p => p.id)) + 1 : 1;
                packages.push({ id: newId, ...packageData });
            }
            
            localStorage.setItem('packages', JSON.stringify(packages));
            loadPackages();
            hideAddPackageForm();
            updateDashboardStats();
            alert(editingId ? 'Package updated successfully!' : 'Package added successfully!');
        }

        // Edit package
        function editPackage(packageId) {
            const pkg = packages.find(p => p.id === packageId);
            if (pkg) {
                document.getElementById('addPackageForm').style.display = 'block';
                document.getElementById('packageFormTitle').textContent = 'Edit Package';
                document.getElementById('editingPackageId').value = packageId;
                document.getElementById('packageName').value = pkg.name;
                document.getElementById('packagePrice').value = pkg.price;
                document.getElementById('packageDuration').value = pkg.duration;
                document.getElementById('packageCategory').value = pkg.category;
                document.getElementById('packageDifficulty').value = pkg.difficulty;
                document.getElementById('packageDescription').value = pkg.description;
            }
        }

        // Toggle package status
        function togglePackageStatus(packageId) {
            const pkg = packages.find(p => p.id === packageId);
            if (pkg) {
                pkg.status = pkg.status === 'Active' ? 'Inactive' : 'Active';
                localStorage.setItem('packages', JSON.stringify(packages));
                loadPackages();
                updateDashboardStats();
                alert(`Package "${pkg.name}" ${pkg.status === 'Active' ? 'activated' : 'deactivated'}!`);
            }
        }

        // Search packages
        function searchPackages() {
            const search = document.getElementById('packageSearch').value.toLowerCase();
            const rows = document.querySelectorAll('#packagesTableBody tr');
            
            rows.forEach(row => {
                const text = row.textContent.toLowerCase();
                row.style.display = text.includes(search) || search === '' ? '' : 'none';
            });
        }

        // Filter packages
        function filterPackages() {
            const categoryFilter = document.getElementById('packageFilterCategory').value;
            const statusFilter = document.getElementById('packageFilterStatus').value;
            const rows = document.querySelectorAll('#packagesTableBody tr');
            
            rows.forEach(row => {
                const category = row.cells[2].textContent.trim();
                const status = row.cells[5].textContent.trim();
                
                const categoryMatch = categoryFilter === 'all' || category === categoryFilter;
                const statusMatch = statusFilter === 'all' || status === statusFilter;
                
                row.style.display = categoryMatch && statusMatch ? '' : 'none';
            });
        }

        // Load bookings
        function loadBookings() {
            const tbody = document.getElementById('bookingsTableBody');
            tbody.innerHTML = '';
            
            bookings.forEach(booking => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${booking.id}</td>
                    <td>${booking.customer}</td>
                    <td>${booking.package}</td>
                    <td>${booking.date}</td>
                    <td>₹${booking.amount.toLocaleString('en-IN')}</td>
                    <td><span class="status-badge status-${booking.status.toLowerCase()}">${booking.status}</span></td>
                    <td>
                        <button class="btn btn-sm">View</button>
                    </td>
                `;
            });
        }

        // Load users
        function loadUsers() {
            const tbody = document.getElementById('usersTableBody');
            tbody.innerHTML = '';
            
            users.forEach(user => {
                const row = tbody.insertRow();
                row.innerHTML = `
                    <td>${user.id}</td>
                    <td>${user.name}</td>
                    <td>${user.email}</td>
                    <td>${user.phone}</td>
                    <td>${user.registered}</td>
                    <td><span class="status-badge status-${user.status.toLowerCase()}">${user.status}</span></td>
                    <td>
                        <button class="btn btn-sm">View</button>
                    </td>
                `;
            });
        }

        // Refresh data
        function refreshData() {
            packages = JSON.parse(localStorage.getItem('packages') || '[]');
            bookings = JSON.parse(localStorage.getItem('bookings') || '[]');
            users = JSON.parse(localStorage.getItem('users') || '[]');
            updateDashboardStats();
            
            const currentSection = document.querySelector('.content-section:not([style*="display: none"])');
            if (currentSection) {
                if (currentSection.id === 'packages') loadPackages();
                else if (currentSection.id === 'bookings') loadBookings();
                else if (currentSection.id === 'users') loadUsers();
            }
        }

        // Logout
        function logout() {
            localStorage.removeItem('isLoggedIn');
            window.location.href = 'login.html';
        }

        // Check authentication
        if (localStorage.getItem('isLoggedIn') !== 'true') {
            window.location.href = 'login.html';
        }

        // Initialize dashboard on load
        updateDashboardStats();
    </script>
</body>
</html>
